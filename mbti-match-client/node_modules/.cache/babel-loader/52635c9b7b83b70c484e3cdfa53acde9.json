{"ast":null,"code":"import _slicedToArray from \"C:\\\\test\\\\mbti-match-client-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\test\\\\mbti-match-client-master\\\\src\\\\containers\\\\ListMembers.js\";\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Tab from '../components/Tab/TabList';\nimport List from '../components/ListMembers/List';\nimport ChoiceTab from '../components/ListMembers/ChoiceTab';\nimport NextTab from '../components/ListMembers/NextTab';\nimport Notice from '../components/Notice/Notice';\nimport Popup from '../components/Popup/Popup';\nimport { getUsers, getLikeMe, addLikeUser, postChat } from '../api';\nimport { objectKeysToCamelCase } from '../utility/formattingData';\nimport { loadUsersSuccess, increaseChoiceCount, resetChoiceCount, increasePageIndex, noticeSelectedAll, addNewUsers, leaveMemberList } from '../actions';\nconst ListMembers = () => {\n  const _useState = useState('front'),\n    _useState2 = _slicedToArray(_useState, 2),\n    view = _useState2[0],\n    setView = _useState2[1];\n  const _useState3 = useState('level0'),\n    _useState4 = _slicedToArray(_useState3, 2),\n    matchData = _useState4[0],\n    setMatchData = _useState4[1];\n  const _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    viewPopup = _useState6[0],\n    setViewPopup = _useState6[1];\n  const _useState7 = useState('유저 정보를 가져오고 있습니다.🙏'),\n    _useState8 = _slicedToArray(_useState7, 2),\n    notice = _useState8[0],\n    setnotice = _useState8[1];\n  const dispatch = useDispatch();\n  const _useSelector = useSelector(state => ({\n      users: state.users,\n      user: state.user,\n      pageIndex: state.pageIndex,\n      hasUsersNotice: state.hasUsersNotice,\n      choiceCount: state.choiceCount,\n      totalUserCount: state.totalUserCount,\n      totalChoiceCount: state.totalChoiceCount\n    })),\n    partners = _useSelector.users,\n    user = _useSelector.user,\n    pageIndex = _useSelector.pageIndex,\n    hasUsersNotice = _useSelector.hasUsersNotice,\n    choiceCount = _useSelector.choiceCount,\n    totalUserCount = _useSelector.totalUserCount,\n    totalChoiceCount = _useSelector.totalChoiceCount;\n  const LIMIT = 5;\n  useEffect(() => {\n    const setUsers = async () => {\n      const result = await getUsers({\n        limit: LIMIT,\n        pageIndex: 0\n      });\n      if (!result.total_user_count) {\n        setnotice('모든 회원을 선택 하셨습니다~! 고생하셨습니다!👏');\n        dispatch(noticeSelectedAll());\n        return;\n      }\n      dispatch(loadUsersSuccess(objectKeysToCamelCase(result)));\n    };\n    setUsers();\n    return () => {\n      dispatch(leaveMemberList());\n    };\n  }, [dispatch]);\n  const onLikeClick = async () => {\n    const likeMeList = await getLikeMe();\n    if (likeMeList.includes(partners[choiceCount].id)) {\n      await postChat(partners[choiceCount].id);\n      setViewPopup(true);\n    } else {\n      addLikeUser(partners[choiceCount].id);\n    }\n    setView('back');\n    const compatibility = Object.keys(user.mbti).find(key => {\n      if (typeof user.mbti[key] === 'object') {\n        return user.mbti[key].includes(partners[choiceCount].mbti.type);\n      }\n    });\n    setMatchData(compatibility);\n  };\n  const onUnLikeClick = async () => {\n    await addLikeUser(partners[choiceCount].id);\n    onNextClick();\n  };\n  const onNextClick = async () => {\n    if (totalUserCount === totalChoiceCount + 1) {\n      setnotice('모든 회원을 선택 하셨습니다~! 고생하셨습니다!');\n      dispatch(noticeSelectedAll());\n      return;\n    }\n\n    // if (choiceCount === LIMIT - 1 || choiceCount + 2 === partners.length) {\n    //   let result = await getUsers({ limit: LIMIT, pageIndex: pageIndex + 1 });\n\n    //   if (!result.total_user_count || !partners.length) {\n    //     setnotice('모든 회원을 선택 하셨습니다~! 고생하셨습니다!');\n    //     dispatch(noticeSelectedAll());\n    //     return;\n    //   }\n\n    //   console.log('users' + result.length);\n    //   // result = await objectKeysToCamelCase(result);\n    //   dispatch(addNewUsers(result));\n    //   dispatch(resetChoiceCount());\n    //   dispatch(increasePageIndex());\n    //   setView('front');\n    //   setMatchData('level0');\n    //   return;\n    // }\n\n    dispatch(increaseChoiceCount());\n    setView('front');\n    setMatchData('level0');\n  };\n  const onPopupClick = () => {\n    setViewPopup(false);\n  };\n  return React.createElement(\"div\", {\n    className: \"page-wrap\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(Tab, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }), hasUsersNotice ? React.createElement(Notice, {\n    notice: notice,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }) : React.createElement(React.Fragment, null, React.createElement(List, {\n    partner: partners[choiceCount],\n    view: view,\n    matchData: matchData,\n    myMbti: user.mbti.type,\n    myName: user.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }), view === 'front' && React.createElement(ChoiceTab, {\n    onLikeClick: onLikeClick,\n    onUnLikeClick: onUnLikeClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }) || React.createElement(NextTab, {\n    onNextClick: onNextClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }), viewPopup && React.createElement(Popup, {\n    onPopupClick: onPopupClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  })));\n};\nexport default ListMembers;","map":{"version":3,"names":["React","useState","useEffect","useSelector","useDispatch","Tab","List","ChoiceTab","NextTab","Notice","Popup","getUsers","getLikeMe","addLikeUser","postChat","objectKeysToCamelCase","loadUsersSuccess","increaseChoiceCount","resetChoiceCount","increasePageIndex","noticeSelectedAll","addNewUsers","leaveMemberList","ListMembers","_useState","_useState2","_slicedToArray","view","setView","_useState3","_useState4","matchData","setMatchData","_useState5","_useState6","viewPopup","setViewPopup","_useState7","_useState8","notice","setnotice","dispatch","_useSelector","state","users","user","pageIndex","hasUsersNotice","choiceCount","totalUserCount","totalChoiceCount","partners","LIMIT","setUsers","result","limit","total_user_count","onLikeClick","likeMeList","includes","id","compatibility","Object","keys","mbti","find","key","type","onUnLikeClick","onNextClick","onPopupClick","createElement","className","__source","fileName","_jsxFileName","lineNumber","__self","Fragment","partner","myMbti","myName","name"],"sources":["C:/test/mbti-match-client-master/src/containers/ListMembers.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Tab from '../components/Tab/TabList';\nimport List from '../components/ListMembers/List';\nimport ChoiceTab from '../components/ListMembers/ChoiceTab';\nimport NextTab from '../components/ListMembers/NextTab';\nimport Notice from '../components/Notice/Notice';\nimport Popup from '../components/Popup/Popup';\nimport { getUsers, getLikeMe, addLikeUser, postChat } from '../api';\nimport { objectKeysToCamelCase } from '../utility/formattingData';\nimport {\n  loadUsersSuccess,\n  increaseChoiceCount,\n  resetChoiceCount,\n  increasePageIndex,\n  noticeSelectedAll,\n  addNewUsers,\n  leaveMemberList\n} from '../actions';\n\nconst ListMembers = () => {\n  const [view, setView] = useState('front');\n  const [matchData, setMatchData] = useState('level0');\n  const [viewPopup, setViewPopup] = useState(false);\n  const [notice, setnotice] = useState('유저 정보를 가져오고 있습니다.🙏');\n  const dispatch = useDispatch();\n  const {\n    users: partners,\n    user,\n    pageIndex,\n    hasUsersNotice,\n    choiceCount,\n    totalUserCount,\n    totalChoiceCount\n  } = useSelector(state => ({\n    users: state.users,\n    user: state.user,\n    pageIndex: state.pageIndex,\n    hasUsersNotice: state.hasUsersNotice,\n    choiceCount: state.choiceCount,\n    totalUserCount: state.totalUserCount,\n    totalChoiceCount: state.totalChoiceCount\n  }));\n\n  const LIMIT = 5;\n\n  useEffect(() => {\n    const setUsers = async () => {\n      const result = await getUsers({ limit: LIMIT, pageIndex: 0 });\n\n      if (!result.total_user_count) {\n        setnotice('모든 회원을 선택 하셨습니다~! 고생하셨습니다!👏');\n        dispatch(noticeSelectedAll());\n        return;\n      }\n\n      dispatch(loadUsersSuccess(objectKeysToCamelCase(result)));\n    };\n\n    setUsers();\n    return () => {\n      dispatch(leaveMemberList());\n    };\n  }, [dispatch]);\n\n  const onLikeClick = async () => {\n    const likeMeList = await getLikeMe();\n    if (likeMeList.includes(partners[choiceCount].id)) {\n      await postChat(partners[choiceCount].id);\n      setViewPopup(true);\n    } else {\n      addLikeUser(partners[choiceCount].id);\n    }\n\n    setView('back');\n    const compatibility = Object.keys(user.mbti).find(key => {\n      if (typeof user.mbti[key] === 'object') {\n        return user.mbti[key].includes(partners[choiceCount].mbti.type);\n      }\n    });\n\n    setMatchData(compatibility);\n  };\n\n  const onUnLikeClick = async () => {\n    await addLikeUser(partners[choiceCount].id);\n\n    onNextClick();\n  };\n\n  const onNextClick = async () => {\n    if (totalUserCount === totalChoiceCount + 1) {\n      setnotice('모든 회원을 선택 하셨습니다~! 고생하셨습니다!');\n      dispatch(noticeSelectedAll());\n      return;\n    }\n\n    // if (choiceCount === LIMIT - 1 || choiceCount + 2 === partners.length) {\n    //   let result = await getUsers({ limit: LIMIT, pageIndex: pageIndex + 1 });\n\n    //   if (!result.total_user_count || !partners.length) {\n    //     setnotice('모든 회원을 선택 하셨습니다~! 고생하셨습니다!');\n    //     dispatch(noticeSelectedAll());\n    //     return;\n    //   }\n\n    //   console.log('users' + result.length);\n    //   // result = await objectKeysToCamelCase(result);\n    //   dispatch(addNewUsers(result));\n    //   dispatch(resetChoiceCount());\n    //   dispatch(increasePageIndex());\n    //   setView('front');\n    //   setMatchData('level0');\n    //   return;\n    // }\n\n    dispatch(increaseChoiceCount());\n    setView('front');\n    setMatchData('level0');\n  };\n\n  const onPopupClick = () => {\n    setViewPopup(false);\n  };\n\n  return (\n    <div className=\"page-wrap\">\n      <Tab />\n      {hasUsersNotice ? (\n        <Notice notice={notice} />\n      ) : (\n        <>\n          <List\n            partner={partners[choiceCount]}\n            view={view}\n            matchData={matchData}\n            myMbti={user.mbti.type}\n            myName={user.name}\n          />\n          {(view === 'front' && (\n            <ChoiceTab\n              onLikeClick={onLikeClick}\n              onUnLikeClick={onUnLikeClick}\n            />\n          )) || <NextTab onNextClick={onNextClick} />}\n          {viewPopup && <Popup onPopupClick={onPopupClick} />}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default ListMembers;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}